# -*- coding: utf-8 -*-
"""
=============================================================================
ID: skills/Example_Program_Research.py
Description: 
    ç§‘ç ”å°ˆç”¨æ¨™æº–æ¨£æ¿ (V3.0 - Universal Framework Edition)
    å°ˆä¾› AI æ¨¡å‹ç”ŸæˆæŠ€èƒ½ä»£ç¢¼æ™‚åƒè€ƒçš„çµæ§‹æ¡†æ¶ã€‚
    
    âš ï¸ é‡è¦ï¼šæ­¤æ–‡ä»¶æ˜¯ã€Œç©ºç™½æ¡†æ¶ã€ï¼Œä¸åŒ…å«ä»»ä½•å¯¦éš›é‚è¼¯ï¼
    âš ï¸ AI å¿…é ˆæ ¹æ“š MASTER_SPEC å¡«å…¥å®Œæ•´çš„å¯¦ä½œé‚è¼¯ã€‚
    
API è¦æ ¼:
    - generate(level=1, **kwargs) â†’ dict
      è¿”å›: {
          'question_text': str,    # LaTeX æ ¼å¼é¡Œç›®ï¼ˆç”± clean_latex_output åŒ…è£ï¼‰
          'correct_answer': str,   # ç´”æ•¸å­—æ ¼å¼ç­”æ¡ˆ
          'answer': str,           # åŒ correct_answer
          'mode': int              # å›ºå®šç‚º 1
      }
    
    - check(user_answer, correct_answer) â†’ dict
      è¿”å›: {'correct': bool, 'result': str}
=============================================================================
"""

# ============================================================================
# [é è¼‰ç’°å¢ƒ] ä»¥ä¸‹æ¨¡çµ„å·²ç”±ç³»çµ±è‡ªå‹•æ³¨å…¥ï¼Œç„¡éœ€ import
# ============================================================================
# import random
# import math
# from fractions import Fraction
# import re
# import ast
# import operator
#
# å¯ç”¨å·¥å…·å‡½æ•¸ï¼š
#   - fmt_num(num, signed=False, op=False)  # æ ¼å¼åŒ–æ•¸å­—ç‚º LaTeX
#   - to_latex(num)                         # è½‰æ›åˆ†æ•¸ç‚º LaTeX
#   - clean_latex_output(q)                 # æ¸…æ´—ä¸¦åŒ…è£é¡Œç›®ï¼ˆè‡ªå‹•åŠ  $ï¼‰
#   - safe_choice(seq)                      # å®‰å…¨çš„ random.choice
#   - check(user, correct)                  # ç­”æ¡ˆé©—è­‰
#   - op_latex = {'+': '+', '-': '-', '*': '\\times', '/': '\\div'}
#
# æ•¸è«–å·¥å…·ï¼ˆå¦‚éœ€ä½¿ç”¨ï¼‰ï¼š
#   - gcd(a, b), lcm(a, b), is_prime(n), get_factors(n)
# ============================================================================

def generate(level=1, **kwargs):
    """
    [æ ¸å¿ƒå‡½æ•¸] æ ¹æ“š MASTER_SPEC ç”Ÿæˆéš¨æ©Ÿé¡Œç›®
    
    å¯¦ä½œè¦æ±‚ï¼š
    1. æ ¹æ“š MASTER_SPEC çš„ entities å®šç¾©ç”Ÿæˆæ‰€æœ‰å¿…è¦è®Šæ•¸
    2. æ ¹æ“š MASTER_SPEC çš„ construction åŸ·è¡Œæ‰€æœ‰è¨ˆç®—æ­¥é©Ÿ
    3. æ ¹æ“š MASTER_SPEC çš„ formatting.question_display æ§‹å»ºé¡Œç›®
    4. æ ¹æ“š MASTER_SPEC çš„ formatting.answer_display æ ¼å¼åŒ–ç­”æ¡ˆ
    5. ç¢ºä¿ç¬¦åˆ MASTER_SPEC çš„ complexity_requirements
    
    âš ï¸ ç¦æ­¢äº‹é …ï¼š
    - ç¦æ­¢ä½¿ç”¨ eval/exec/safe_eval
    - ç¦æ­¢é‡æ–°å®šç¾© fmt_num/to_latex/clean_latex_output
    - ç¦æ­¢ import ä»»ä½•æ¨¡çµ„ï¼ˆå·²é è¼‰ï¼‰
    - ç¦æ­¢ç°¡åŒ–æˆ–çœç•¥ MASTER_SPEC çš„ä»»ä½•è¦æ±‚
    """
    # ========================================================================
    # [æ­¥é©Ÿ 1] æ ¹æ“š MASTER_SPEC ç”Ÿæˆè®Šæ•¸
    # ========================================================================
    # TODO: å¯¦ä½œ MASTER_SPEC ä¸­ entities å®šç¾©çš„æ‰€æœ‰è®Šæ•¸
    # ç¯„ä¾‹æ¡†æ¶ï¼ˆå¿…é ˆæ ¹æ“š MASTER_SPEC æ›¿æ›ï¼‰ï¼š
    #   - å¦‚æœéœ€è¦æ•´æ•¸: n = random.randint(a, b)
    #   - å¦‚æœéœ€è¦åˆ†æ•¸: f = Fraction(random.randint(1, 10), random.randint(2, 10))
    #   - å¦‚æœéœ€è¦é¿å… 0: while denom == 0: denom = random.randint(...)
    
    # ========================================================================
    # [æ­¥é©Ÿ 2] æ ¹æ“š MASTER_SPEC åŸ·è¡Œè¨ˆç®—
    # ========================================================================
    # TODO: å¯¦ä½œ MASTER_SPEC ä¸­ construction å®šç¾©çš„æ‰€æœ‰è¨ˆç®—æ­¥é©Ÿ
    # ç¯„ä¾‹æ¡†æ¶ï¼ˆå¿…é ˆæ ¹æ“š MASTER_SPEC æ›¿æ›ï¼‰ï¼š
    #   - ä½¿ç”¨ Python é‹ç®—ç¬¦: result = (a + b) * c
    #   - è™•ç† Fraction: result = Fraction(1, 2) + Fraction(3, 4)
    #   - å¯¦ç¾æ‹¬è™Ÿé‚è¼¯: if bracket_type == 'left': result = (a op1 b) op2 c
    
    # ========================================================================
    # [æ­¥é©Ÿ 3] æ§‹å»ºé¡Œç›® LaTeXï¼ˆé‡è¦ï¼æ³¨æ„ä¸­æ–‡è™•ç†ï¼‰
    # ========================================================================
    # TODO: æ ¹æ“š MASTER_SPEC çš„ formatting.question_display
    
    # ğŸ”´ LaTeX æ ¼å¼åŒ–éµå¾‹ï¼š
    # 1. ä¸­æ–‡å­—å’Œæ–‡å­—æ•˜è¿°æ°¸é åœ¨ $ $ å¤–é¢
    # 2. æ•¸å­¸å¼å­æ°¸é åœ¨ $ $ è£¡é¢
    # 3. ä½¿ç”¨ clean_latex_output() è‡ªå‹•åŒ…è£ï¼ˆåƒ…å‘¼å«ä¸€æ¬¡ï¼‰
    
    # âœ… æ¨¡å¼ Aï¼šç´”æ•¸å­¸å¼ï¼ˆç„¡ä¸­æ–‡ï¼‰
    # q = f"{fmt_num(a)} {op_latex['+']} {fmt_num(b)}"
    # q = clean_latex_output(q)  # è‡ªå‹•è®Šæˆ $a + b$
    
    # âœ… æ¨¡å¼ Bï¼šä¸­æ–‡ + æ•¸å­¸å¼
    # math_expr = f"{fmt_num(a)} {op_latex['+']} {fmt_num(b)}"
    # math_expr = clean_latex_output(math_expr)  # $a + b$
    # q = f"è¨ˆç®— {math_expr} çš„å€¼"  # "è¨ˆç®— $a + b$ çš„å€¼"
    
    # âœ… æ¨¡å¼ Cï¼šæ‹¬è™Ÿçµæ§‹
    # if bracket_type == 'left_group':
    #     q = f"({fmt_num(a)} {op_latex[op1]} {fmt_num(b)}) {op_latex[op2]} {fmt_num(c)}"
    # q = clean_latex_output(q)
    
    # âŒ éŒ¯èª¤ï¼šä¸­æ–‡åœ¨ $ $ å…§
    # q = f"è¨ˆç®— {fmt_num(a)} + {fmt_num(b)} çš„å€¼"
    # q = clean_latex_output(q)  # âŒ è®Šæˆ $è¨ˆç®— a + b çš„å€¼$ï¼ˆä¸­æ–‡ç„¡æ³•æ¸²æŸ“ï¼‰
    
    # âŒ éŒ¯èª¤ï¼šé‡è¤‡åŒ…è£
    # q = f"${fmt_num(a)} + {fmt_num(b)}$"
    # q = clean_latex_output(q)  # âŒ è®Šæˆ $$a + b$$
    
    # ========================================================================
    # [æ­¥é©Ÿ 4] æ ¼å¼åŒ–ç­”æ¡ˆç‚ºç´”æ•¸å­—ï¼ˆä¸ä½¿ç”¨ LaTeXï¼‰
    # ========================================================================
    # TODO: æ ¹æ“š MASTER_SPEC çš„ formatting.answer_display
    # æ ¼å¼ç¯„ä¾‹ï¼š
    #   - æ•´æ•¸: a = str(result)                    # "42"
    #   - åˆ†æ•¸: a = str(result)                    # "3/7"
    #   - å¸¶åˆ†æ•¸: a = f"{whole} {num}/{den}"      # "2 3/7"
    
    # ========================================================================
    # [è‡¨æ™‚ä½”ä½] é˜²æ­¢æœªå¯¦ä½œæ™‚çš„éŒ¯èª¤ï¼ˆå¯¦ä½œå¾Œè«‹åˆªé™¤ï¼‰
    # ========================================================================
    q = "âš ï¸ å°šæœªå¯¦ä½œ MASTER_SPEC é‚è¼¯"
    a = "N/A"
    
    # ========================================================================
    # [æ­¥é©Ÿ 5] è¿”å›æ¨™æº–æ ¼å¼ï¼ˆå›ºå®šä¸è®Šï¼‰
    # ========================================================================
    return {
        'question_text': q,
        'correct_answer': a,
        'answer': a,
        'mode': 1
    }

def check(user_answer, correct_answer):
    """
    [è©•åˆ†å‡½æ•¸] æ¨™æº–ç­”æ¡ˆé©—è­‰é‚è¼¯ï¼ˆç”±ç³»çµ±è‡ªå‹•æ³¨å…¥å¼·åŒ–ç‰ˆæœ¬ï¼‰
    
    æ­¤å‡½æ•¸æœƒè¢« code_generator æ›¿æ›ç‚ºæ›´å¼·å¤§çš„ç‰ˆæœ¬ï¼Œæ”¯æ´ï¼š
    - åˆ†æ•¸ç­‰åƒ¹æ€§æª¢æŸ¥ï¼ˆ3/6 == 1/2ï¼‰
    - å¸¶åˆ†æ•¸æ ¼å¼æª¢æŸ¥ï¼ˆ2 1/2 == 5/2ï¼‰
    - å®¹å·®æ¯”è¼ƒï¼ˆå°æ•¸è¿‘ä¼¼ï¼‰
    
    åŸºç¤ç‰ˆæœ¬ï¼š
    """
    u = str(user_answer).strip()
    c = str(correct_answer).strip()
    return {
        "correct": u == c,
        "result": "æ­£ç¢º" if u == c else "éŒ¯èª¤"
    }
