```python
def generate(level=1, **kwargs):
    import random
    from fractions import Fraction

    # 生成 operand_int
    def gen_operand_int():
        while True:
            val = random.randint(-50, 50)
            if val != 0:
                return val

    # 生成 operand_fraction
    def gen_operand_fraction():
        while True:
            numerator = random.randint(-20, 20)
            denominator = random.randint(2, 20)
            if numerator != 0 and denominator != 0:
                frac = Fraction(numerator, denominator).limit_denominator()
                if frac.denominator <= 20 and abs(frac.numerator) <= 20 and not frac.denominator == 1:
                    return frac

    # 生成 operand_decimal
    def gen_operand_decimal():
        while True:
            numerator = random.randint(-20, 20)
            denominator = 10 ** random.randint(1, 2)
            if numerator != 0 and denominator != 0:
                dec = Fraction(numerator, denominator).limit_denominator()
                return float(dec)

    # 選擇運算符
    def gen_operator():
        return random.choice(['+', '-', '*', '/'])

    # 確保除數不為零且可化簡
    def safe_divide(a, b):
        if a % b == 0:
            return Fraction(a // b)
        else:
            return Fraction(a, b)

    # 選擇運算數類型
    operand_types = ['operand_int', 'operand_fraction', 'operand_decimal']
    num_operands = random.choice([3, 4])
    bracket_type = None if num_operands == 4 else random.choice(['none', 'left_group', 'right_group'])

    operands = []
    for _ in range(num_operands):
        operand_type = random.choice(operand_types)
        if operand_type == 'operand_int':
            operands.append(gen_operand_int())
        elif operand_type == 'operand_fraction':
            operands.append(gen_operand_fraction())
        else:
            operands.append(gen_operand_decimal())

    # 確保至少一個是分數或小數
    while all(isinstance(op, int) for op in operands):
        idx = random.randint(0, num_operands - 1)
        if isinstance(operands[idx], int):
            if random.choice([True, False]):
                operands[idx] = gen_operand_fraction()
            else:
                operands[idx] = gen_operand_decimal()

    # 確保至少一個是負數
    while all(op >= 0 for op in operands) or all(op <= 0 for op in operands):
        idx = random.randint(0, num_operands - 1)
        operands[idx] *= -1

    operators = [gen_operator() for _ in range(num_operands - 1)]
    # 確保至少一個是乘法或除法
    while not any(op in ['*', '/'] for op in operators):
        idx = random.randint(0, num_operands - 2)
        if operators[idx] == '+':
            operators[idx] = '*'
        else:
            operators[idx] = '/'

    # 確保除數不為零且可化簡
    while any(isinstance(op, Fraction) and op.denominator == 1 for op in operands):
        idx = random.randint(0, num_operands - 1)
        if isinstance(operands[idx], int):
            operands[idx] = gen_operand_fraction()

    # 計算最終答案
    final_result = operands[0]
    temp_parts = [fmt_num(final_result)]
    for i in range(len(operators)):
        op = operators[i]
        next_op = operands[i + 1]

        if op == '+':
            final_result += next_op
        elif op == '-':
            final_result -= next_op
        elif op == '*':
            final_result *= next_op
        else:  # /
            final_result = safe_divide(final_result, next_op)

        temp_parts.append(op_latex[op])
        temp_parts.append(fmt_num(next_op))

    if bracket_type == 'left_group':
        q_str = f"({temp_parts[0]} {temp_parts[1]} {temp_parts[2]}) {temp_parts[3]} {temp_parts[4]}"
    elif bracket_type == 'right_group':
        q_str = f"{temp_parts[0]} {temp_parts[1]} ({temp_parts[2]} {temp_parts[3]} {temp_parts[4]})"
    else:
        q_str = " ".join(temp_parts)

    question_output = clean_latex_output(q_str)
    a = str(final_result) if isinstance(final_result, int) else str(Fraction(final_result).limit_denominator())

    return {
        'question_text': question_output,
        'correct_answer': a,
        'answer': a,
        'mode': 1
    }
```